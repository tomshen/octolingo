<?xml version="1.0" encoding="UTF-8"?>
<Module>
  <ModulePrefs title="Octolingo">
    <Require feature="rpc"/>
    <Require feature="views"/>
  </ModulePrefs>
  <Content type="html">
    <![CDATA[
    <html>
    <head>
      <link type="text/css" rel="stylesheet" href="https://162.243.204.184/style.css">
      <script src="//plus.google.com/hangouts/_/api/v1/hangout.js"></script>
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
      <script src="https://162.243.204.184/message.js"></script>

      <script src="https://162.243.204.184/message-handler.js"></script>
    </head>
    <body>
      <div id="container">
      </div>

      <script id="app" type="text/javascript">
        function init() {
          gapi.hangout.onApiReady.add(function(event) {
            if (event.isApiReady) {
              var speechRecognition = null;
              var a = new MessageHandler("container", function (language) {
                speechRecognition.lang = language;
              });
              speechRecognition = initSpeechRecognition("en", function (event) {
                a.newMessage(new Message(gapi.hangout.getLocalParticipant().person.displayName,
                  event.results[event.resultIndex][0].transcript, a.selectedLanguage))
              });

              a.start();
            }
          });
        }
        gadgets.util.registerOnLoadHandler(init);
      </script>
    </body>
    </html>
    ]]>
  </Content>
</Module>
