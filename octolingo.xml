<?xml version="1.0" encoding="UTF-8"?>
<Module>
  <ModulePrefs title="Octolingo">
    <Require feature="rpc"/>
    <Require feature="views"/>
  </ModulePrefs>
  <Content type="html">
    <![CDATA[
    <html>
    <head>
      <link type="text/css" rel="stylesheet" href="https://162.243.204.184/style.css">
      <script src="//plus.google.com/hangouts/_/api/v1/hangout.js"></script>
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
      <script src="https://162.243.204.184/message.js"></script>

      <script src="https://162.243.204.184/message-handler.js"></script>
    </head>
    <body>
      <div class="title">
	      <div class="app-name">Octolingo</div>
		      <div class="logo">
			      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="octolingo-logo" x="0px" y="0px" width="30px" height="30px" viewBox="0 0 100 100" enable-background="new 0 0 100 100" xml:space="preserve">
			        <g>
                <path fill="#181818" d="M83.755,50.834c-0.767-0.354-1.901-0.523-3.522-0.081c0.634-2.24,0.009-3.988-1.062-5.021   c-1.785-1.722-4.676-1.507-6.722,0.498c-2.083,2.043-4.499,3.367-6.027,4.077l-0.224-12.98c0-8.926-7.262-16.189-16.188-16.189   c-0.011,0-0.023,0.001-0.035,0.001c-0.011,0-0.024-0.001-0.035-0.001c-8.926,0-16.188,7.263-16.188,16.162l-0.224,13.008   c-1.528-0.71-3.944-2.036-6.027-4.077c-2.046-2.005-4.936-2.22-6.721-0.498c-1.071,1.033-1.696,2.781-1.062,5.021   c-1.623-0.442-2.758-0.273-3.523,0.081c-2.629,1.215-3.42,3.96-2.115,7.341c1.392,3.609,3.892,5.541,8.478,7.924   c-0.232,0.582-0.368,1.208-0.375,1.859c-0.027,2.37,1.756,5.179,6.87,5.296c0.225,0.006,0.508,0.008,0.833,0.008   c1.071,0,2.601-0.028,4.019-0.078c-0.132,0.371-0.189,0.723-0.203,1.02c-0.058,1.252,0.556,2.586,1.684,3.659   c1.068,1.018,2.481,1.54,4.141,1.54c0.484,0,0.989-0.045,1.513-0.134c3.362-0.574,7.408-3.095,9.736-5.868   c1.551,2.025,3.855,3.924,6.741,5.079c1.296,0.518,2.512,0.776,3.612,0.776c1.483,0,2.754-0.467,3.726-1.394   c1.127-1.073,1.741-2.407,1.684-3.659c-0.014-0.295-0.07-0.645-0.202-1.016c1.335,0.048,2.754,0.074,3.762,0.074   c0.312,0,0.584-0.002,0.803-0.008c5.115-0.117,6.896-2.926,6.87-5.296c-0.008-0.651-0.144-1.277-0.376-1.857   c4.588-2.385,7.086-4.316,8.479-7.926C87.175,54.794,86.385,52.049,83.755,50.834z M74.631,48.457   c0.925-0.907,1.915-0.926,2.374-0.481c0.639,0.615,0.65,2.556-1.928,5.385c-0.027,0.029-0.048,0.067-0.073,0.099   c-0.213,0.15-0.422,0.297-0.643,0.462c-2.44,1.815-5.372,2.032-6.892,1.319c-0.7-0.329-0.929-0.762-1.009-1.072   c0.014-0.089,0.023-0.18,0.022-0.272l-0.004-0.22C67.889,53.123,71.528,51.499,74.631,48.457z M24.87,53.36   c-2.578-2.829-2.565-4.77-1.927-5.385c0.46-0.444,1.449-0.426,2.374,0.481c3.105,3.044,6.744,4.667,8.152,5.221l-0.004,0.218   c-0.002,0.095,0.008,0.186,0.022,0.274c-0.081,0.312-0.311,0.741-1.008,1.07c-1.521,0.715-4.453,0.496-6.891-1.32   c-0.221-0.164-0.433-0.312-0.646-0.463C24.917,53.426,24.897,53.39,24.87,53.36z M82.961,57.053   c-0.999,2.586-2.731,4.102-7.585,6.578c-0.77-0.506-1.668-0.805-2.618-0.805c-3.541,0-6.658-1.068-6.706-1.085   c-0.812-0.284-1.7,0.144-1.984,0.955c-0.286,0.812,0.141,1.701,0.953,1.987c0.146,0.052,3.637,1.262,7.737,1.262   c1.068,0,1.881,1.081,1.893,2.049c0.014,1.289-1.415,2.087-3.824,2.143c-1.639,0.041-6.04-0.076-7.321-0.248   c-0.084-0.012-0.166-0.012-0.248-0.01c-1.439-1.276-2.769-2.58-4.078-4.308c-0.521-0.686-1.497-0.819-2.184-0.299   c-0.686,0.521-0.82,1.499-0.3,2.185c2.037,2.686,4.12,4.462,6.328,6.341c0.014,0.014,0.029,0.024,0.046,0.036   c0.34,0.271,0.348,0.455,0.351,0.514c0.013,0.271-0.204,0.768-0.719,1.258c-1.062,1.011-3.172,0.323-4.028-0.022   c-3.604-1.443-6.871-4.952-6.993-7.512c-0.042-0.859-0.781-1.524-1.631-1.481c-0.86,0.04-1.525,0.771-1.483,1.631   c0.033,0.69,0.211,1.444,0.51,2.221c-1.386,2.256-5.307,5.197-8.564,5.755c-1.328,0.225-2.33,0.026-2.979-0.591   c-0.514-0.49-0.731-0.986-0.719-1.258c0.003-0.059,0.012-0.243,0.352-0.514c0.015-0.012,0.029-0.022,0.044-0.036   c2.206-1.878,4.289-3.651,6.329-6.341c0.521-0.686,0.387-1.663-0.3-2.185c-0.686-0.521-1.663-0.387-2.184,0.299   c-1.31,1.728-2.639,3.031-4.078,4.308c-0.082-0.002-0.164-0.002-0.249,0.01c-1.233,0.167-5.936,0.287-7.606,0.248   c-2.41-0.056-3.839-0.854-3.824-2.143c0.011-0.968,0.823-2.049,1.893-2.049c4.1,0,7.59-1.21,7.737-1.262   c0.812-0.286,1.238-1.172,0.955-1.985c-0.284-0.812-1.173-1.239-1.987-0.957c-0.031,0.012-3.155,1.085-6.705,1.085   c-0.951,0-1.85,0.299-2.619,0.805c-4.853-2.477-6.587-3.992-7.585-6.578c-1.032-2.673,0.093-3.192,0.515-3.39   c0.752-0.348,3.19,0.5,6.225,2.757c3.092,2.303,7.238,2.978,10.079,1.642c1.717-0.808,2.754-2.286,2.846-4.057   c0.202-3.88,0.284-16.148,0.289-16.679c0-7.196,5.843-13.05,13.034-13.069c7.191,0.02,13.036,5.873,13.036,13.08   c0.003,0.52,0.086,12.789,0.287,16.668c0.093,1.771,1.129,3.249,2.846,4.057c2.842,1.336,6.986,0.661,10.079-1.642   c3.034-2.257,5.472-3.104,6.225-2.757C82.87,53.86,83.993,54.38,82.961,57.053z"/>
                <path fill="#181818" d="M44.141,45.028c-1.916,0-3.474,1.56-3.474,3.475v4.775c0,1.915,1.558,3.474,3.474,3.474   s3.475-1.559,3.475-3.474v-4.775C47.616,46.588,46.057,45.028,44.141,45.028z M46.057,53.278c0,1.058-0.859,1.915-1.916,1.915   c-1.056,0-1.916-0.857-1.916-1.915v-4.775c0-1.055,0.86-1.915,1.916-1.915c1.057,0,1.916,0.86,1.916,1.915V53.278z"/>
                <path fill="#181818" d="M56.199,45.028c-1.917,0-3.475,1.56-3.475,3.475v4.775c0,1.915,1.558,3.474,3.475,3.474   c1.915,0,3.474-1.559,3.474-3.474v-4.775C59.673,46.588,58.114,45.028,56.199,45.028z M58.114,53.278   c0,1.058-0.859,1.915-1.915,1.915c-1.057,0-1.917-0.857-1.917-1.915v-4.775c0-1.055,0.86-1.915,1.917-1.915   c1.056,0,1.915,0.86,1.915,1.915V53.278z"/>
              </g>
	          </svg>
	        </div>
        </div>
    </div>
    <div id="container">
    </div>

      <script id="app" type="text/javascript">
        function init() {
          gapi.hangout.onApiReady.add(function(event) {
            if (event.isApiReady) {
              var speechRecognition = null;
              var a = new MessageHandler("container", function (language) {
                speechRecognition.lang = language;
                a.refresh();
              });
              gapi.hangout.data.onMessageReceived.add(function (event) {
                var message = JSON.parse(event.message);
                Message.save(message);
                Message.translate(message, a.selectedLanguage, function (translatedMessage) {
                  Message.speak(translatedMessage);
                });
                a.refresh();
              });
              speechRecognition = initSpeechRecognition("en", function (event) {
                var message = new Message(
                  gapi.hangout.getLocalParticipant().person.displayName,
                  event.results[event.resultIndex][0].transcript, 
                  a.selectedLanguage
                );
                message.save()
                a.refresh();
              });

              a.start();
            }
          });
        }

        gadgets.util.registerOnLoadHandler(init);
      </script>
    </body>
    </html>
    ]]>
  </Content>
</Module>
